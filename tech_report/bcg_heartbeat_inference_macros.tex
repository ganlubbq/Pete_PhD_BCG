%%% MACROS FOR MATHEMATICAL NOTATION IN BCG HEARTBEAT INFERENCE PAPER %%%

% Functions and operators
\newcommand{\half}{\frac{1}{2}}                                 % Half
\DeclareMathOperator{\sinc}{sinc}                               % Sinc
\DeclareMathOperator{\trace}{Tr}                                % Trace
\newcommand{\expect}[1]{\mathbb{E}_{#1}}                        % Expectation
\newcommand{\variance}[1]{\mathbb{V}_{#1}}                      % Variance
\newcommand{\magdet}[1]{\left|\left| #1 \right|\right|}         % Magnitude of the determinant
\newcommand{\indic}[1]{\mathbbm{1}_{#1}}                        % Indicator function
\newcommand{\bigo}[1]{\mathcal{O}\left({#1}\right)}             % Big O
\newcommand{\mhaccept}{\alpha}                                  % Metropolis-Hastings acceptance probability

% Density families
\newcommand{\normalden}[3]{\mathcal{N}\left(#1\left|#2,#3\right.\right)}    % Normal density
\newcommand{\gammaden}[3]{\mathcal{G}\left(#1\left|#2,#3\right.\right)}            % Gamma density
\newcommand{\studenttden}[4]{\mathcal{ST}\left(#1|#2,#3,#4\right)}          % Student-t density

% Particle shizzle
\newcommand{\pss}[2][]{^{(#2)#1}}               % Particle superscript
\newcommand{\pw}[1]{w_{#1}}                     % Particle weight
\newcommand{\predpw}[1]{\hat{w}_{#1}}           % Predictive particle weight
\newcommand{\npw}[1]{\bar{w}_{#1}}              % Normalised particle weight
\newcommand{\naw}[1]{\bar{v}_{#1}}              % Normalised auxiliary weight
\newcommand{\anc}[1]{a_{#1}}                    % Particle ancestor

% Time variables
\newcommand{\ti}{n}                             % Observation/time indexing
\newcommand{\timax}{N}                          % Maximum Observation/time index
\newcommand{\ot}[1]{t_{#1}}                     % Observation time
\newcommand{\ct}{t}                             % Continuous time

% Latent state and observations
\newcommand{\cls}[1]{x(#1)}                     % Continuous time latent state
\newcommand{\ob}[1]{y_{#1}}                     % Observation

% Changepoints
\newcommand{\sqi}{s}                                                        % Sequence index
\newcommand{\cpi}{k}                                                        % Changepoint indexing
\newcommand{\dmrcpi}[2][]{\ifstrempty{#1}{K_{#2}}{{K_{#2}^{[#1]}}}}         % Most recent changepoint index preceeding an observation time
\newcommand{\cmrcpi}[2][]{\ifstrempty{#1}{K(#2)}{{K^{[#1]}(#2)}}}           % Most recent changepoint index preceeding a continuous time
\newcommand{\cpt}[2][]{\ifstrempty{#1}{\tau_{#2}}{{\tau_{#2}^{[#1]}}}}      % Changepoint time
\newcommand{\cpp}[2][]{\ifstrempty{#1}{u_{#2}}{{u_{#2}^{[#1]}}}}            % Changepoint parameter
\newcommand{\cplp}[2][]{\ifstrempty{#1}{z_{#2}}{{z_{#2}^{[#1]}}}}           % Changepoint linear parameter
\newcommand{\cp}[2][]{\ifstrempty{#1}{\theta_{#2}}{\theta_{#1 || #2}}}      % Changepoint set

% Extra changepoint things for algorithms
\newcommand{\diffcpi}[1]{K^{[#1]}}                                          % Number of changepoints in the window
\newcommand{\tmpcpt}[2][]{\ifstrempty{#1}{\tau_{#2}^*}{{\tau_{#2}^{*[#1]}}}}                    % Temporary Intermediate changepoint time
\newcommand{\repcp}[2][]{\ifstrempty{#1}{\tilde{\theta}_{#2}}{\tilde{\theta}_{#1 || #2}}}       % Changepoint set replacement

% State and observation dynamics
\newcommand{\transfun}{F}                       % Deterministic transition function
\newcommand{\cplppriormn}{m_0}                  % Prior mean for changepoint linear parameter
\newcommand{\cplppriorvr}{P_0}                  % Prior variance for changepoint linear parameter
\newcommand{\cplptransmat}{A}                   % Parameter transition matrix for Rao-Blackwellisable models
\newcommand{\cplptranscov}{Q}                   % Parameter covariance matrix for Rao-Blackwellisable models
\newcommand{\obsmat}{H}                         % Observation matrix
\newcommand{\obscov}{R}                         % Observation covariance matrix

% Probabilities
\newcommand{\prob}{P}                                                                                       % Probability
\newcommand{\survfunc}[4][1]{\ifstrempty{#1}{S\left(#2,#3,#4\right)}{S^{[#1]}\left(#2,#3,#4\right)}}        % Survivor function
\newcommand{\transden}[2][]{\ifstrempty{#1}{p_{#2}}{p^{[#1]}_{#2}}}                                         % Transition density
\newcommand{\impden}[2]{q_{#1 || #2}}           % Changepoint importance density
\newcommand{\artden}[2]{\rho_{#1 || #2}}        % Changepoint artificial density
\newcommand{\adjden}{\varphi}                   % Changepoint time ``adjustment'' density
\newcommand{\tmpden}{\psi}                      % Intermediate changepoint artificial target density
\newcommand{\lhood}{p_{y}}                      % Likelihood

% Probability spaces
\newcommand{\reals}{\mathbb{R}}                 % Reals
\newcommand{\lsspace}{\mathbb{X}}               % Space for latent state
\newcommand{\cpspace}[2][]{\ifstrempty{#1}{\Theta_{#2}}{\Theta_{#1 || #2}}}             % Space for changepoints
\newcommand{\cptspace}[2][]{\ifstrempty{#1}{\mathbb{T}_{#2}}{\mathbb{T}_{#1 || #2}}}    % Space for changepoint times
\newcommand{\cppspace}{\mathbb{U}}             % Space for a changepoint

% Generic algorithm features
\newcommand{\cplpmn}[1]{m_{#1}}                 % Heartbeat waveform mean
\newcommand{\cplpvr}[1]{P_{#1}}                 % Heartbeat waveform variance
\newcommand{\cplppredmn}[1]{\hat{m}_{#1}}       % Heartbeat waveform predicted mean
\newcommand{\cplppredvr}[1]{\hat{P}_{#1}}       % Heartbeat waveform predicted variance

% Block filtering variables
\newcommand{\winlen}{L}                         % Window length
\newcommand{\blocklen}{B}                       % Block length

% Generic model features
\newcommand{\gamshape}[1]{a_{#1}}               % Gamma density shape (for both beat times and minimum durations)
\newcommand{\gamscale}[1]{b_{#1}}               % Gamma density shape (for both beat times and minimum durations)

% Heartbeat model
\newcommand{\period}{\Delta}                                                    % Sampling period
\newcommand{\hbst}[2][]{\ifstrempty{#1}{b_{#2}}{b_{#2}^{[#1]}}}                 % Heartbeat start time
\newcommand{\hbmd}[2][]{\ifstrempty{#1}{\lambda_{#2}}{\lambda_{#2}^{[#1]}}}     % Heartbeat minimum duration
\newcommand{\hbwf}[2][]{\ifstrempty{#1}{\omega_{#2}}{\omega_{#2}^{[#1]}}}       % Heartbeat waveform
\newcommand{\hs}[3][]{\ifstrempty{#1}{\zeta_{#2}(#3)}{\zeta_{#2}^{[#1]}(#3)}}   % Heartbeat signal
\newcommand{\hbwflen}{D}                                                        % Length of heartbeat waveform
\newcommand{\intrp}[1][]{f}                                                     % Interpolation factor
\newcommand{\intrpmat}{F}                                                       % Interpolation factor
\newcommand{\si}{v}                                                             % Sensor index
\newcommand{\peri}{s}                                                           % Person index (equivalent to sequence index)
\newcommand{\hbwfpriorcov}{P}                                                   % Waveform prior covariance
\newcommand{\hbwftranscov}{Q}                                                   % Waveform transition covariance
\newcommand{\hbobscov}[1][]{\sigma_y^2 I}                                       % Observation covariance
\newcommand{\hbwfmn}[1]{m_{#1}}                                                 % Heartbeat waveform mean
\newcommand{\hbwfvr}[1]{P_{#1}}                                                 % Heartbeat waveform variance
\newcommand{\window}{\phi}                                                      % Window function for likelihood function 

